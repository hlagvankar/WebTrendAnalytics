CREATE TABLE TEMP AS SELECT * FROM PUR_INFO WHERE PUR_IP='193.201.224.24';

DROP TABLE EXISTING_IP;

CREATE TABLE EXISTING_IP
(
IP STRING
);

INSERT INTO TABLE EXISTING_IP SELECT '69.12.75.10' FROM TEMP;
INSERT INTO TABLE EXISTING_IP SELECT '216.45.55.39' FROM TEMP;
INSERT INTO TABLE EXISTING_IP SELECT '66.249.79.91' FROM TEMP;
INSERT INTO TABLE EXISTING_IP SELECT '66.249.79.99' FROM TEMP;

INSERT INTO TABLE FINAL_OUTPUT
SELECT IP_ADD,'','','','','','','SR_4'
FROM
(

SELECT DISTINCT IP_ADD FROM PARSE_2ND
A LEFT OUTER JOIN EXISTING_IP B ON (A.IP_ADD=B.IP)
WHERE B.IP IS NULL
) A;


CREATE TABLE EXISTING_IP_TMP
AS
SELECT DISTINCT IP FROM
(
SELECT IP FROM EXISTING_IP
UNION ALL
SELECT IP_ADD IP FROM PARSE_2ND
) A;

DROP TABLE EXISTING_IP;

CREATE TABLE EXISTING_IP AS SELECT * FROM EXISTING_IP_TMP;